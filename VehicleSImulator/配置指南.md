# 车辆模拟器配置指南

## 快速开始

### 1. 设置MongoDB连接

您需要提供您的MongoDB云数据库连接字符串。请按以下步骤操作：

#### 方法一：创建 .env 文件（推荐）

1. 复制示例文件：
```bash
cp .env.example .env
```

2. 编辑 `.env` 文件，将以下内容替换为您的实际信息：
```env
MONGODB_URI=您的MongoDB连接字符串
DATABASE_NAME=123
COLLECTION_NAME=vehicle
```

#### 方法二：直接修改 config.py 文件

在 `config.py` 文件中找到以下行：
```python
MONGODB_URI = os.getenv('MONGODB_URI', 'mongodb://localhost:27017/')
```

将其修改为：
```python
MONGODB_URI = "您的MongoDB连接字符串"
```

### 2. MongoDB连接字符串格式

典型的MongoDB Atlas连接字符串格式：
```
mongodb+srv://用户名:密码@集群地址.mongodb.net/数据库名?retryWrites=true&w=majority
```

例如：
```
mongodb+srv://myuser:mypassword@cluster0.abcde.mongodb.net/123?retryWrites=true&w=majority
```

### 3. 运行模拟器

配置完成后，您可以使用以下任一方式启动：

#### 快速启动（推荐）
```bash
python start_simulator.py
```

#### 直接启动
```bash
# 交互模式
python main.py interactive

# 连续运行模式
python main.py continuous

# 测试模式
python main.py test
```

## 配置参数说明

在 `.env` 文件或 `config.py` 中可以配置：

- `MONGODB_URI`: MongoDB连接字符串
- `DATABASE_NAME`: 数据库名称（默认：123）
- `COLLECTION_NAME`: 集合名称（默认：vehicle）
- `UPDATE_INTERVAL`: 数据更新间隔秒数（默认：5）
- `VEHICLE_COUNT`: 模拟车辆数量（默认：2）

## 运行模式说明

### 交互模式（推荐新手）
- 提供命令行界面
- 可以手动控制启动/停止
- 支持实时状态查看
- 命令：start, stop, status, clear, quit

### 连续运行模式
- 启动后自动开始模拟
- 适合长时间运行
- 按 Ctrl+C 停止

### 测试模式
- 运行30秒测试
- 验证系统功能
- 适合初次配置验证

## 故障排除

### 常见错误

1. **ModuleNotFoundError: No module named 'pymongo'**
   ```bash
   pip install -r requirements.txt
   ```

2. **数据库连接失败**
   - 检查MongoDB连接字符串是否正确
   - 确认网络连接正常
   - 验证用户名密码是否正确

3. **权限错误**
   - 确认MongoDB用户有读写权限
   - 检查IP白名单设置

### 调试模式

如果遇到问题，可以启用调试模式：
```bash
python main.py --debug test
```

这将输出详细的调试信息。

## 下一步

配置完成后，系统将：

1. 创建2辆模拟车辆（车牌：京A12345、沪B67890）
2. 每5秒更新一次车辆数据到MongoDB
3. 模拟真实的车辆传感器数据
4. 在指定的地理区域内模拟车辆移动

您可以通过MongoDB数据库客户端查看实时更新的车辆数据。 